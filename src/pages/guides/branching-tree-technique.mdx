---
description: Organize Solidity tests as decision trees with the Branching Tree Technique and Bulloak.
---

## Branching Tree Technique

The [Branching Tree Technique (BTT)](https://github.com/PaulRBerg/btt-examples) is a methodology for organizing Solidity tests by modeling all conditions and outcomes as a decision tree — each branch represents a condition, each leaf a concrete test case.

BTT maps directly onto Foundry's test naming conventions. For example, a function `transfer` with two conditions (`when paused` / `when not paused`) and a sub-condition (`when balance is insufficient`) becomes:

```
transfer
├── when paused
│   └── it should revert
└── when not paused
    ├── when balance is insufficient
    │   └── it should revert
    └── when balance is sufficient
        └── it should transfer the tokens
```

This tree structure translates into Foundry test files by using `_` as the condition separator and a modifier-based setup pattern:

```solidity
contract TransferTest is Test {
    // "when not paused, when balance is sufficient"
    function test_Transfer_WhenNotPaused_WhenBalanceSufficient() public {
        // arrange, act, assert
    }

    // "when not paused, when balance is insufficient"
    function test_RevertWhen_NotPaused_BalanceInsufficient() public {
        vm.expectRevert(Token.InsufficientBalance.selector);
        token.transfer(bob, 1000);
    }
}
```

### Bulloak

[Bulloak](https://bulloak.dev/) is a CLI tool that automates BTT workflows with Foundry. It takes a `.tree` spec file as input and can:

- **Scaffold** a Solidity test file from the tree
- **Check** that an existing test file matches the tree spec

**Install:**

```bash
cargo install bulloak
```

**Create a spec file (`transfer.tree`):**

```
transfer.sol
└── when not paused
    ├── when balance is insufficient
    │   └── it should revert
    └── when balance is sufficient
        └── it should transfer the tokens
```

**Scaffold a test file:**

```bash
bulloak scaffold transfer.tree
```

**Check an existing test file matches the spec:**

```bash
bulloak check transfer.tree
```

Bulloak integrates naturally with `forge test` — the generated test skeletons are standard Foundry test contracts that you fill in with assertions.

For more information see the [Bulloak GitHub](https://github.com/alexfertel/bulloak) and the [BTT presentation at Solidity Summit 2023](https://prberg.com/presentations/solidity-summit-2023/).
